select 
{{ add_surrograte_key("RESTAURANT_ID","RESTAURANT_NAME","LOCATION_ID") }} as  RESTAURANT_SK,
RESTAURANT_ID,
RESTAURANT_NAME,
CUISINE_TYPE,
DOUBLE_SHARING_PRICE,
RESTAURANT_PHONE_NUMBER,
OPENING_TIME,
CLOSING_TIME,
LOCATION_ID,
IS_ACTIVE,
RESTAURANT_STATUS,
LOCALITY,
RESTAURANT_ADDRESS,
LATITUDE,
LONGITUDE,
DBT_VALID_FROM as EFF_START_DATE, 
DBT_VALID_TO as EFF_END_DATE,
{{ handle_is_current("DBT_VALID_TO") }} AS IS_CURRENT
from {{ ref('restaurant_snapshot') }}